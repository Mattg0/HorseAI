/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
üöÄ Starting batch prediction job: batch_20251105_125548
   Total races: 23
   Workers: 3
   Chunk size: 50
   Memory limit: 4096.0MB
   Database: 2years

‚úì Loaded 21 selected features from models/2025-11-02/2years_061730/feature_selector.json
[5%] Loading races from database...
[15%] Loaded 23 races, starting predictions...
[20%] Processing chunk 1/1 (Mem: 1367MB)...
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
2025-11-05 12:56:30,220 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,221 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:30,221 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,221 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,222 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:30,222 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,223 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,226 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:30,226 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,227 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,227 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:30,231 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:56:59,425 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,425 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:59,425 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,429 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,431 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,431 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:59,431 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,433 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,433 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:56:59,433 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,434 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:56:59,436 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:57:14,442 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,443 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:14,443 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,446 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:57:14,501 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,502 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:14,502 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,504 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,509 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,509 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:14,509 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:14,512 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:57:29,762 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,762 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:29,762 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,765 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,767 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,768 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,768 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:29,768 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,768 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:29,768 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,770 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:29,770 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:57:44,628 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,629 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:44,629 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,631 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,633 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,634 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:44,634 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,636 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,636 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:57:44,636 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,636 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:57:44,638 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:58:01,357 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,357 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:01,357 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,359 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,363 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,363 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:01,363 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,363 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,364 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:01,364 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,366 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:01,366 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:58:15,400 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,401 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:15,401 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,403 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,403 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,404 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:15,404 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,406 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:58:15,415 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:15,415 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:15,415 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:58:15,418 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
2025-11-05 12:58:30,337 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:30,337 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:30,338 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:30,338 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:30,338 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 12:58:30,338 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:30,340 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 12:58:30,340 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/sklearn/ensemble/_base.py:168: UserWarning: Loky-backed parallel loops cannot be called in a multiprocessing, setting n_jobs=1
  n_jobs = min(effective_n_jobs(n_jobs), n_estimators)
‚úì Loaded 21 selected features from models/2025-11-02/2years_061730/feature_selector.json
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 116,574 (from 16 horses)
  üìä Processing 16 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 116,574 (from 16 horses)
  üìä Processing 16 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 172,709 (from 15 horses)
  üìä Processing 15 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 172,709 (from 15 horses)
  üìä Processing 15 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 164,778 (from 11 horses)
  üìä Processing 11 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 164,778 (from 11 horses)
  üìä Processing 11 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 100,000 (from 14 horses)
  üìä Processing 14 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 100,000 (from 14 horses)
  üìä Processing 14 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 144,243 (from 9 horses)
  üìä Processing 9 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 144,243 (from 9 horses)
  üìä Processing 9 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 100,000 (from 5 horses)
  üìä Processing 5 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 100,000 (from 5 horses)
  üìä Processing 5 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 246,351 (from 7 horses)
  üìä Processing 7 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 246,351 (from 7 horses)
  üìä Processing 7 horses for feature calculation...
  üîÑ Using temporal calculations (no data leakage mode)
  ‚úÖ Preserving existing career stats from database (prediction mode)
üèá Field mean earnings per race: 100,000 (from 9 horses)
  üìä Processing 9 horses for feature calculation...
Feature cleanup: 253 ‚Üí 228 (25 removed)
üèá Field mean earnings per race: 100,000 (from 9 horses)
  üìä Processing 9 horses for feature calculation...
[95%] Storing predictions to database...
[100%] Complete! Processed 23 races in 164.3s

============================================================
‚úÖ BATCH PREDICTION COMPLETE
============================================================
  Job ID: batch_20251105_125548
  Total races: 23
  Successful: 23
  Failed: 0
  Total time: 170.45s
  Throughput: 0.1 races/second
============================================================
