/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
ğŸš€ Starting batch prediction job: batch_20251118_212440
   Total races: 32
   Workers: 3
   Chunk size: 50
   Memory limit: 4096.0MB
   Database: 2years

âœ“ Loaded 25 selected features from models/2025-11-13/2years_144333/feature_selector.json
[5%] Loading races from database...
[15%] Loaded 32 races, starting predictions...
[20%] Processing chunk 1/1 (Mem: 701MB)...
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
2025-11-18 21:24:54,018 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,018 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,018 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,019 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,022 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,022 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:24:54,023 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,389 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,390 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:17,390 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,392 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,395 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,399 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,401 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:17,409 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:17,433 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,459 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,462 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:17,462 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,804 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,804 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:39,804 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,804 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,805 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:39,805 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,807 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,807 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,812 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,812 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:25:39,812 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:25:39,815 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,431 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,432 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:03,432 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,435 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,439 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,440 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:03,440 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,443 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,444 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,444 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:03,444 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:03,447 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,544 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,544 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,545 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:24,545 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,545 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:24,545 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,547 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,547 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,556 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,556 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:24,556 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:24,560 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,010 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,012 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:46,012 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,015 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,015 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,016 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:46,016 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,019 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,022 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,023 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:26:46,023 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:26:46,026 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,580 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,581 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:08,581 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,583 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,583 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:08,583 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,584 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,586 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,587 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,587 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:08,587 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:08,591 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,461 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,462 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:25,462 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,464 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,464 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:25,464 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,464 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,466 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,466 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:25,466 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,467 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:25,469 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,756 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,757 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:41,757 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,760 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,760 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,760 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:41,760 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,761 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,761 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:27:41,761 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,763 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:27:41,764 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,304 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,304 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:28:03,304 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,306 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,308 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,308 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:28:03,308 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:03,310 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,417 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,418 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:28:24,418 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,419 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,419 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:28:24,419 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,421 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:24,423 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:45,313 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:45,314 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-18 21:28:45,314 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-18 21:28:45,316 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
âœ“ Loaded 25 selected features from models/2025-11-13/2years_144333/feature_selector.json
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 284,451 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 284,451 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 226,250 (from 14 horses)
  ğŸ“Š Processing 14 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 226,250 (from 14 horses)
  ğŸ“Š Processing 14 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 100,000 (from 7 horses)
  ğŸ“Š Processing 7 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 100,000 (from 7 horses)
  ğŸ“Š Processing 7 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 164,449 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 164,449 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 100,000 (from 9 horses)
  ğŸ“Š Processing 9 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 100,000 (from 9 horses)
  ğŸ“Š Processing 9 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 135,685 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 135,685 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 208,312 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 208,312 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 226,688 (from 18 horses)
  ğŸ“Š Processing 18 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 226,688 (from 18 horses)
  ğŸ“Š Processing 18 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 243,750 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 243,750 (from 11 horses)
  ğŸ“Š Processing 11 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 198,119 (from 9 horses)
  ğŸ“Š Processing 9 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 198,119 (from 9 horses)
  ğŸ“Š Processing 9 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 268,905 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 268,905 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 171,239 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 171,239 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
[95%] Storing predictions to database...
[100%] Complete! Processed 32 races in 255.8s

============================================================
âœ… BATCH PREDICTION COMPLETE
============================================================
  Job ID: batch_20251118_212440
  Total races: 32
  Successful: 32
  Failed: 0
  Total time: 255.97s
  Throughput: 0.1 races/second
============================================================
