/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
2025-11-23 15:05:34,728 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-23 15:05:34,728 - core.orchestrators.feature_selector - INFO - Dropped 111 features for rf model
2025-11-23 15:05:34,728 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-23 15:05:34,732 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
ğŸš€ Starting batch prediction job: batch_20251123_150527
   Total races: 1
   Workers: 3
   Chunk size: 50
   Memory limit: 4096.0MB
   Database: 2years

âœ“ Loaded 25 selected features from models/2025-11-13/2years_144333/feature_selector.json
[5%] Loading races from database...
[15%] Loaded 1 races, starting predictions...
[20%] Processing race 1/1...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 165,583 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 251 â†’ 226 (25 removed)
ğŸ‡ Field mean earnings per race: 165,583 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Storage: TabNet predictions available (16 horses)
[95%] Storing predictions to database...
[100%] Complete! Processed 1 races in 20.5s

============================================================
âœ… BATCH PREDICTION COMPLETE
============================================================
  Job ID: batch_20251123_150527
  Total races: 1
  Successful: 1
  Failed: 0
  Total time: 20.68s
  Throughput: 0.0 races/second
============================================================
