/Users/mattg0/miniconda3/envs/HorseAIv2/lib/python3.11/site-packages/pytorch_tabnet/abstract_model.py:82: UserWarning: Device used : cpu
  warnings.warn(f"Device used : {self.device}")
2025-11-05 13:34:41,745 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 13:34:41,746 - core.orchestrators.feature_selector - INFO - Dropped 113 features for rf model
2025-11-05 13:34:41,746 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
2025-11-05 13:34:41,751 - core.orchestrators.feature_selector - INFO - RF features: 114 domain features (no embeddings)
ğŸš€ Starting batch prediction job: batch_20251105_133430
   Total races: 1
   Workers: 3
   Chunk size: 50
   Memory limit: 4096.0MB
   Database: 2years

âœ“ Loaded 21 selected features from models/2025-11-02/2years_061730/feature_selector.json
[5%] Loading races from database...
[15%] Loaded 1 races, starting predictions...
[20%] Processing race 1/1...
  ğŸ”„ Using temporal calculations (no data leakage mode)
  âœ… Preserving existing career stats from database (prediction mode)
ğŸ‡ Field mean earnings per race: 100,000 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Feature cleanup: 253 â†’ 228 (25 removed)
ğŸ‡ Field mean earnings per race: 100,000 (from 16 horses)
  ğŸ“Š Processing 16 horses for feature calculation...
Storage: TabNet predictions available (16 horses)
[95%] Storing predictions to database...
[100%] Complete! Processed 1 races in 22.0s

============================================================
âœ… BATCH PREDICTION COMPLETE
============================================================
  Job ID: batch_20251105_133430
  Total races: 1
  Successful: 1
  Failed: 0
  Total time: 27.88s
  Throughput: 0.0 races/second
============================================================
